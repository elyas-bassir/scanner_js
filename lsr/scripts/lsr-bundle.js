"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){var r={};window._ACX_getText=function(e){for(var t=arguments.length,a=new Array(1<t?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];if(e=e.replace("\n","\\n"),0===a.length)return r[e]||e;var o=r[e]||e,i="";return o.split("%").forEach(function(e){var t=parseInt(e,10);if(!t||isNaN(t))return i+=e,!1;var n=(t+"").length;i+=a[t-1]+e.substr(n)}),i};var h=window._ACX_getText,m=Object.freeze({session_detection_failure:function(){return h("login Sequence Recorder was unable to find a session detection pattern using the captured requests. You can either define a pattern manually or navigate to a page which is accessible only from a valid user session.")}}),y=[],g=!1,b=!1,o={},w={},e=window.location.hash;function k(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};"function"==typeof t&&(n=t,t={});var a=function(){var e=new Uint8Array(16);window.crypto&&window.crypto.getRandomValues?window.crypto.getRandomValues(e):window.msCrypto&&window.msCrypto.getRandomValues&&window.msCrypto.getRandomValues(e);for(var t="",n=0;n<e.length;n++)t+=("0"+e[n].toString(16)).slice(-2);return t}();o[a]=n,window.top.postMessage({type:"request",payload:{callbackId:a,id:e,data:t}},window.location.origin)}function L(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};window.top.postMessage({type:"event",payload:{type:e,detail:t}},window.location.origin)}function a(a,e){var t,n,o=new Blob([a],{type:"application/octet-stream"}).size;t=o,n=function(e,t){if(e)return!1;var n;n=function(e){if(e)return!1;var t;t=function(){L("lsrsaved")},k("updateTargetConfig",{targetId:w.targetId},function(){t(null)})},k("uploadLSR",{url:t,data:a},function(){n(null)})},k("getLSRUploadURL",{targetId:w.targetId,name:"sequence.lsr",size:t},function(e){var t=e.upload_url;n(null,t)})}function i(a,e){var t,n,o=new Blob([a],{type:"application/octet-stream"}).size;t=o,n=function(e,t){if(e)return!1;var n;n=function(e){if(e)return!1;L("blrsaved")},k("uploadBLR",{url:t,data:a},function(){n(null)})},k("getBLRUploadURL",{targetId:w.targetId,name:"logic.blr",size:t},function(e){var t=e.upload_url;n(null,t)})}function s(e,t){var n=t=t||{},r=n.preloadLSR,s=n.importSelenium,c=window._ACX_ui,d=window._ACX_lsrstream,l=[],u=[],f=null;switch(w.mode){case"standalone":document.body.classList.remove("wizard"),document.body.classList.add("standalone");break;case"manual":document.body.classList.remove("wizard"),document.body.classList.remove("standalone"),document.body.classList.add("manual");break;case"oauth":c.setCloseButtonText(h("Close"));case"logic":document.body.classList.remove("wizard"),document.body.classList.remove("standalone"),document.body.classList.add("logic")}function p(){return"standalone"!==w.mode&&"manual"!==w.mode}d.on("error",function(){L("connectionerror")}),d.on("close",function(){L("connectionclose")});var v=null;d.on("message",function(e){switch(e.event){case"windowlist":c.updateWindowList(e.payload);break;case"detectionstarted":c.showDetectionModal(function(){d.stopDetectFromHistory(),c.hideDetectionModal()});break;case"detectioncomplete":e.payload.patternFound||e.payload.cancelled?c.hideDetectionModal():(p()&&d.setMode("detect"),c.hideDetectionModal(),c.alert(m.session_detection_failure()));break;case"detectionpattern":c.alert(h("login Sequence Recorder has successfully identified a pattern to use for detecting session validity.")),c.loadPattern(e.payload.pattern);break;case"statusupdate":0<e.payload.detectHistoryLength&&c.enableDetectFromHistory();break;case"urlchange":c.updateURL(e.payload.url),c.updateHistoryButtons(e.payload.history);break;case"frame":v=e.payload;break;case"frameblob":v.blob=e.payload,c.drawFrame(v);break;case"ready":c.setMode(e.payload.mode),d.sendViewportSize(c.getFrameSize());var t=e.payload.providers;"logic"===w.mode?t.includes("loginactions")?(c.showSiteloginInitModal(),d.requestFromProvider("loginactions",{url:w.navigate},function(e){var t=e.error,n=e.response;if(c.hideModals(),t)return c.alert("Site login failed (".concat(t,")")),!1;c.notifyReadyForInput();var a=!1;y=n,c.showSiteloginPlayModal(),g=!0,d.playActionList(n,function(){if(g=!1,c.hideModals(),a)return!1;a=!0,r?c.loadDataFromJSON(r):c.addAction({type:"navigate",target:c.getCurrentURL(),parameters:{friendly:c.getCurrentURL()},timeout:2e4}),d.setMode("record")})})):(r&&c.loadDataFromJSON(r),w.import||d.setMode("record"),w.navigate&&d.navigate(w.navigate),c.notifyReadyForInput()):(("standalone"!==w.mode&&"manual"!==w.mode||"record"===w.state||"oauth"===w.mode)&&d.setMode("record"),w.navigate&&"manual"!==w.mode&&"selenium"!==w.import&&d.navigate(w.navigate),"manual"===w.mode&&c.showPreMIModal(),r?c.loadDataFromJSON(r):s?c.detectFromSeleniumData(s)||c.alert(h("Cannot parse Selenium script")):"object"===_typeof(e.payload.lsrData)&&c.loadDataFromJSON(e.payload.lsrData),c.notifyReadyForInput()),setInterval(function(){d.sendStatus(c.getState())},1e3);break;case"action":"recordUserAction"===e.payload.type&&c.addAction(e.payload.args);break;case"showdialog":var n=e.payload;switch(n.type){case"alert":c.alert(n.message,function(){n.callback.accept()});break;case"confirm":c.confirm(n.message,function(e){e?n.callback.accept():n.callback.dismiss()});break;case"prompt":c.prompt(n.message,function(e){null!==e?n.callback.accept(e):n.callback.dismiss()})}break;case"request":var a=e.payload;if(-1!==l.indexOf(a.savable)){a.callback.continue();break}if(-1!==c.getRestrictionList().indexOf(a.savable)){a.callback.abort();break}i=a,u.push(i),c.showRestrictionModal({editable:{savable:a.savable},showif:{canRestrictToPath:0<a.savable_path.length}},function(e,t){switch(function(e){for(var t=0;t<u.length;t++)if(u[t]===e){u.splice(t,1);break}}(a),e){case"forward_one":l.push(a.savable),a.callback.continue();break;case"forward_all":a.callback.continue(),u.forEach(function(e){e.callback.continue()}),u.length=0,c.cancelNextRestrictionModals(),d.setMode("browse");break;case"restrict_exact":c.addRestriction(t.editable.savable),a.callback.abort();break;case"restrict_path":c.addRestriction(a.savable_path),a.callback.abort()}});break;case"modechange":l.length=0,c.enableInteraction(),c.setMode(e.payload);break;case"playingaction":if(g)break;c.markActionByIndex(e.payload.index);break;case"playbackerror":if(g){c.alert("Site login failed (LSR playback timed out)");break}c.markActionErrorByIndex(e.payload.index),c.alert("Playback of the last action failed");break;case"manualintervention":"manual"===w.mode?c.hidePreMIModal():c.alert(h("Please complete the manual intervention and then press resume."),function(){"logic"===w.mode&&c.hideModals()}),f=e.payload;break;case"navigationerror":e.payload.invalid?c.alert(h("The URL you have entered is invalid")):e.payload.authRequired?c.alert(h("Authentication failed.\nPlease set up HTTP authentication credentials in Spectra interface.")):e.payload.timedOut?c.alert(h("Failed to load page (navigation timeout)")):c.alert(h("Failed to load page")+(e.payload.error?"\n\n".concat(e.payload.error):"")),c.updateURL(e.payload.url);break;case"detectionPatternResult":e.payload.valid?c.alert(h("Pattern was successfully verified.")):c.alert(h("Pattern verification failed"));break;case"cursorchange":var o=e.payload[0];c.setCursor(o);break;case"timeout":L("timeout");break;case"navigationstart":c.showNavigationLoader();break;case"navigationload":c.hideNavigationLoader(),b&&0===c.getActionList().length&&"record"===c.getMode()&&c.addAction({type:"navigate",target:c.getCurrentURL(),parameters:{friendly:c.getCurrentURL()},timeout:2e4}),b=!1;break;case"playdetectactions":c.loadDataFromJSON(e.payload);break;case"playdetectresult":if(c.hideModals(),e.payload.error)switch(e.payload.error){case"session_detect_failed":c.setMode("detect"),c.alert(m.session_detection_failure())}else e.payload.lsr&&0<Object.keys(e.payload.lsr).length&&(c.loadDataFromJSON(e.payload.lsr),c.alert(h("Successfully imported Selenium Script")));break;case"playdetectstate":switch(c.hideModals(),e.payload.state){case"playback":c.showSequenceCheckModal(function(){d.stopPlayAndDetect()});break;case"detect_session":c.showDetectionModal(function(){d.stopPlayAndDetect()});break;case"complete":c.hideModals()}break;case"httperror":switch(e.payload.type){case"lengthexceeded":c.alert("Resource located at "+e.payload.url+" was not loaded as it exceedes the "+e.payload.message.toUpperCase()+" size limit");break;case"oauthstatus":"Ok"===e.payload.message&&k("oauthSequence",c.getJSONForLogic(),function(){})}break;default:console.warn("Unknown Message",e)}var i}),d.on("modechanging",function(){c.disableInteraction()}),d.init(e),c.on("savelsr",function(e){a(e)}),c.on("savelogic",function(e){"oauth"===w.mode?d.close():i(e)}),c.on("paste",function(e){d.sendPastedText(e)}),c.on("startPlayAndDetect",function(e){d.playAndDetect(e)}),c.on("defocusPage",function(){d.defocusPage()}),c.on("switchwindow",function(e){d.switchWindow(e)}),c.on("closewindow",function(e){d.closeWindow(e)}),c.on("buttonclick",function(e){switch(e.id){case"wizcontrols.play":case"controls.play":e.isActive()?d.pausePlayback():0<y.length?(g=!0,c.showSiteloginPlayModal(),d.playActionList(y,function(){c.hideModals(),g=!1,d.playActionList(c.getActionList(),{keepSession:!0})})):d.playActionList(c.getActionList());break;case"wizcontrols.record":case"controls.record":e.isActive()?d.setMode("browse"):d.setMode("record");break;case"wizcontrols.restrict":case"controls.restrict":e.isActive()?d.setMode("browse"):d.setMode("restrict");break;case"wizcontrols.resume":case"controls.resume":f.callback.continue(),f=null,"logic"===w.mode&&c.showSiteloginInitModal();break;case"wizcontrols.stop":case"controls.stop":d.stopPlayback();break;case"wizcontrols.detect_nav":case"controls.detect_nav":e.isActive()?d.setMode("browse"):d.setMode("detect");break;case"controls.detect_history":d.startDetectFromHistory({fieldValues:c.getActionValues(),navigatedURLs:c.getActionNavURLs()});break;case"detection.check":var t=c.getSessionPattern();d.checkDetectionPattern(t)}}),c.on("viewchange",function(e){switch(d.setMode("browse"),e){case"restrictions":p()&&d.setMode("restrict");break;case"sessionDetection":p()&&d.startDetectFromHistory({fieldValues:c.getActionValues(),navigatedURLs:c.getActionNavURLs()})}}),c.on("closerequest",function(e){"manual"===w.mode&&c.showPostMIModal(),d.close(e)}),c.on("urlgoto",function(e){d.navigate(e)}),c.on("pagereload",function(){b=!0,d.reloadPage()}),c.on("historyforward",function(){d.historyNavigate("forward")}),c.on("historyback",function(){d.historyNavigate("back")}),c.on("frame.sizechange",function(e){d.sendViewportSize(e)}),c.on("frame.draw",function(e){d.sendFrameAck(e)}),c.on("canvas.mousemove",function(e){d.sendInput("mousemove",e)}),c.on("canvas.mouseup",function(e){d.sendInput("mouseup",e)}),c.on("canvas.mousedown",function(e){d.sendInput("mousedown",e)}),c.on("canvas.charpress",function(e){1===e.length&&d.sendInput("char",{character:e})}),c.on("canvas.keydown",function(){d.sendInput("keydown",arguments[0])}),c.on("canvas.keyup",function(){d.sendInput("keyup",arguments[0])}),c.on("canvas.keydownup",function(e){d.sendInput("keydownup",e)}),c.on("canvas.mousewheel",function(){d.sendInput("mousewheel",arguments[0])}),c.init(),"true"===w.online&&c.hideManualIntervention()}"#"===e.charAt(0)&&(e=e.substr(1)),e.split(",").forEach(function(e){var t=e.split(":");w[t[0]]=decodeURIComponent(t[1])}),window.addEventListener("message",function(e){return e.origin===window.location.origin&&(!!o[e.data.payload.callbackId]&&((0,o[e.data.payload.callbackId])(e.data.payload.data),void delete o[e.data.payload.callbackId]))}),window.addEventListener("load",function(){var t;!function(){var e=document.getElementById("_localedata");if(!e||!e.innerText)return;var t=e.innerText;try{var n=decodeURIComponent(atob(t)),a=JSON.parse(n);r=a}catch(e){console.warn("failed to load localization data",e)}}(),t=function(e,n){if(e)return L("sessionfailed",e),!1;var t,a,o,i;"standalone"===w.mode?"selenium"===w.import?(i=function(e){s(n,{importSelenium:e})},k("getSeleniumScript",function(e){i(e.data)})):(o=function(e,t){if(e)return!1;s(n,{preloadLSR:t})},k("getTargetLSR",{targetId:w.targetId},function(e){try{var t=JSON.parse(e.contents);o(null,t)}catch(e){o(e.message)}})):"logic"===w.mode&&w.import?(t=w.import,a=function(e,t){s(n,{preloadLSR:t})},k("getImportData",{id:t},function(e){try{var t=JSON.parse(e.data);a(null,t)}catch(e){console.error(e),a(null,{})}})):s(n)},k("getLSREndpoint",{target_id:w.targetId},function(e){t(e.error||null,e.endpoint)})})}(),function(){var e=null,f="open",p="sendkeys",v="type",h="click",m="clickAt",y="selectFrame",g=[f,p,v,h,m,y];(e="undefined"==typeof window?exports:(window._ACX_lsrutils={},window._ACX_lsrutils)).getLSRFromHTML=function(e){var t=new RegExp('<link\\s+rel="selenium\\.base"\\s+href="([^"]+)"\\s*/>'),n=e.match(t);if(null===n)return!1;var a=n.index,s=[];if(0<=a){var c=n[1],d="<tr>\\s*<td>(\\w+)</td>\\s*<td>([^<]*)</td>\\s*<td>([^<]*)</td>\\s*</tr>",o=new RegExp(d,"g");e.match(o).forEach(function(e){var t=new RegExp(d),n=e.match(t)||[],a=(n[1]||"").toLowerCase();if(!g.includes(a))return console.log("Unhandled Selenium Command",a),!1;var o=n[2]||"";switch(a){case f:var i=n[2];if(!i.startsWith("http:")&&!i.startsWith("https://"))try{i=new URL(i,c).href}catch(e){}s.push({type:"navigate",target:i,timeout:2e4,parameters:{}});break;case p:case v:var r=n[3]||"";s.push({type:"change",target:o,timeout:2e4,parameters:{value:r}});break;case h:case m:s.push({type:"click",timeout:2e4,target:o})}}),0!==s.length&&"navigate"===s[0].type||s.unshift({type:"navigate",target:c,timeout:2e4,parameters:{}})}return{actions:s,detection:{},restrictions:[]}},e.getLSRFromSIDE=function(e){var t={};try{t=JSON.parse(e)}catch(e){return!1}if(!t.url||!t.tests||t.tests.length<1)return!1;var n=t.tests[0];if(!n.commands||0===n.commands.length)return!1;var d=t.url,a=n.commands,l=[],u=!1;return a.forEach(function(e){var t=e.command;if(!g.includes(t))return console.log("Unhandled Selenium Command",t),!1;if(u&&t!==y)return console.log("ignoring frame context command"),!1;var n=e.targets||[],a=e.value||"",o=e.target;if(!o.startsWith("css=")&&"open"!==t)for(var i=0;i<n.length;i++){var r=n[i],s=r[0]||"";if((r[1]||"").startsWith("css:")){o=s;break}}switch(t){case f:var c=o;if(!c.startsWith("http:")&&!c.startsWith("https://"))try{c=new URL(c,d).href}catch(e){}l.push({type:"navigate",target:c,timeout:2e4,parameters:{}});break;case p:case v:l.push({type:"change",target:o,parameters:{value:a},timeout:2e4});break;case h:case m:l.push({type:"click",target:o,timeout:2e4});break;case y:e.target&&(u=!e.target.startsWith("relative=parent"))}}),{actions:l,detection:{},restrictions:[]}}}(),window._ACX_lsrstream=function(){var a={},r={},n=!1,o=null,t=null;function s(e,o){var t=a[e]||[],i=[];t.forEach(function(e,t){var n=e.handler,a=e.once;n.apply(null,o),a&&i.unshift(t)}),i.forEach(function(e){t.splice(e,1)})}function i(e,t){var n=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).once;r[e]=r[e]||[],r[e].push({handler:t,once:n})}function c(e,t){if(!o)return console.log("not sent",e,t),!1;1===o.readyState&&o.send(JSON.stringify({cmd:e,payload:t}))}function d(e){var t;try{t=JSON.parse(e)}catch(e){t={}}return t.payload&&function(t){if("object"!==_typeof(t.callback))return;var e=function(e){var n=t.callback[e];t.callback[e]=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[0]);c("invokecallback",{id:n,args:e})}};for(var n in t.callback)e(n)}(t.payload),t}function l(e,t){(o=new WebSocket(e)).addEventListener("open",function(){n=!0,t()}),o.addEventListener("error",function(){s("error")}),o.addEventListener("close",function(){s(n?"close":"error")}),o.addEventListener("message",function(e){if(e.data instanceof Blob)s("message",[{event:"frameblob",payload:e.data}]);else{var t=d(e.data);t.internal?(n=t.event,o=[t.payload],a=r[n]||[],i=[],a.forEach(function(e,t){var n=e.handler,a=e.once;n.apply(null,o),a&&i.unshift(t)}),i.forEach(function(e){a.splice(e,1)})):s("message",[d(e.data)])}var n,o,a,i})}return{init:function(e){var t=e.indexOf(":");l(("http:"===window.location.protocol?"ws":"wss")+e.substr(t),function(e){s("ready")})},navigate:function(e){c("navigate",{url:e})},sendFrameAck:function(e){c("frameAck",{sessionId:e})},on:function(e,t){!function(e,t){var n=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).once;a[e]=a[e]||[],a[e].push({handler:t,once:n})}(e,t)},sendViewportSize:function(e){if(t){if(t.width===e.width&&t.height===e.height)return!1}else t={};t.width=e.width,t.height=e.height,c("setSize",e)},sendInput:function(e,t){c("input",{type:e,detail:t})},historyNavigate:function(e){c("historynavigate",{direction:e})},reloadPage:function(){c("reloadPage")},playActionList:function(e){var t={},n=function(){};(arguments.length<=1?void 0:arguments[1])&&("function"==typeof(arguments.length<=1?void 0:arguments[1])?n=arguments.length<=1?void 0:arguments[1]:t=arguments.length<=1?void 0:arguments[1]),(arguments.length<=1?void 0:arguments[1])&&(arguments.length<=2?void 0:arguments[2])&&("object"===_typeof(arguments.length<=1?void 0:arguments[1])&&(t=arguments.length<=1?void 0:arguments[1]),"function"==typeof(arguments.length<=2?void 0:arguments[2])&&(n=arguments.length<=2?void 0:arguments[2])),i("playbackready",function(){n()},{once:!0}),c("playActionList",{actions:e,keepSession:t.keepSession||!1})},playAndDetect:function(e){c("playAndDetect",{actions:e})},pausePlayback:function(){c("pausePlayback")},stopPlayback:function(){c("stopPlayback")},setMode:function(e){c("setMode",{mode:e})},sendPastedText:function(e){c("paste",{text:e})},sendStatus:function(e){c("status",e)},startDetectFromHistory:function(e){c("startDetectFromHistory",e)},stopDetectFromHistory:function(){c("stopDetectFromHistory")},stopPlayAndDetect:function(){c("stopPlayAndDetect")},checkDetectionPattern:function(e){c("checkDetectionPattern",e)},close:function(e){c("close",e)},switchWindow:function(e){c("switchWindow",{index:parseInt(e,10)})},closeWindow:function(e){c("closeWindow",{index:parseInt(e,10)})},defocusPage:function(){c("defocusPage")},requestFromProvider:function(t,e,n){i("providerresponse",function(e){if(e.id!==t)return!1;n(e.detail)},{once:!0}),c("requestFromProvider",{id:t,details:e})}}}(),window._ACX_ui=function(){var i=window._ACX_getText,c={},r={},t=null;function s(t){var n=this;this.id=t.dataset.id;var a=function(){t.style.backgroundImage="url("+t.dataset.image+")",t.classList.remove("active"),t.classList.remove("disabled"),t.classList.remove("highlight"),"true"===t.dataset.disabled||"true"===t.dataset.forcedisabled?t.classList.add("disabled"):"true"===t.dataset.highlight&&t.classList.add("highlight"),"true"===t.dataset.active&&t.classList.add("active"),"true"===t.dataset.hidden&&t.classList.add("hidden"),"true"!==t.dataset.hidden&&t.classList.remove("hidden")};this.disable=function(){t.dataset.disabled="true",a()},this.forceDisable=function(e){t.dataset.forcedisabled=e?"true":"false",a()},this.enable=function(){t.dataset.disabled="false",a()},this.show=function(){t.dataset.hidden="false",a()},this.hide=function(){t.dataset.hidden="true",a()},this.activate=function(){t.dataset.active="true",a()},this.deactivate=function(){t.dataset.active="false",a()},this.isActive=function(){return"true"===t.dataset.active},this.isDisabled=function(){return"true"===t.dataset.disabled||"true"===t.dataset.forcedisabled},t.addEventListener("click",function(e){e.target&&!e.target.classList.contains("button")||n.isDisabled()||"function"!=typeof n.onclick||n.onclick(n.id)}),a()}function o(e){var t=function(e){var t=(e=e||"").indexOf("\n\n");t=-1===t?e.length:t;for(var n=e.substr(0,t).split("\n"),a=n[0]||"",o={},i=1;i<n.length;i++){var r=n[i],s=r.indexOf(":"),c=r.substr(0,s).toLowerCase(),d=r.substr(s+1).trim();o[c]=d}var l=a.indexOf(" "),u=a.lastIndexOf(" "),f=a.substr(0,l),p=a.substring(l,u).trim(),v=a.substr(u).trim();return-1!==l&&-1!==u||(f=a,v=p=""),{method:f,url:p,version:v,headers:o,savable:e,body:e.substr(t+2)}}(e);this.getDescription=function(){return"".concat(t.method," ").concat(t.url," ").concat(t.version).trim()},this.getContentType=function(){return t.headers["content-type"]||""},this.getMethod=function(){return t.method},this.getBody=function(){return t.body},this.getUrl=function(){return t.url},this.getSavable=function(){return e}}function d(n){n.parameters=n.parameters||{},"number"!=typeof n.timeout&&(n.timeout=2e4);n.timeout;this.getDescription=function(){var e=n.parameters.friendly||n.target;switch(n.type){case"navigate":return i("Navigate to %1",n.target);case"click":return i("Click on %1",e);case"change":return n.parameters.value?n.parameters.password?i('Change %1 to "******"',e):i("Change %1 to %2",e,n.parameters.value):i("Change %1",e);case"manual":return i("Manual Intervention");case"keypress":return n.parameters.key?i("Press %1 in %2",n.parameters.key,e):i("Press key in %1",e);default:return i("Perform %1 on %2",n.type,e)}},this.getTimeout=function(){return n.timeout},this.setTimeout=function(e){n.timeout=0|e},this.getType=function(){return n.type},this.setType=function(e){n.type=e},this.getTarget=function(){return n.target},this.setTarget=function(e){n.target=e},this.getParameters=function(){return n.parameters},this.setParameters=function(e){if("object"!==_typeof(e))return!1;for(var t in e)e[t]&&(n.parameters[t]=e[t])},this.isPasswordValue=function(){return n.parameters.password||!1}}function n(e){var t=e.cloneNode(!0);t.classList.remove("template"),this.root=t,this.childs={};for(var n=t.getElementsByTagName("*"),a=0;a<n.length;a++){var o=n[a];o.dataset.id&&delete(this.childs[o.dataset.id]=o).dataset.id}}var l={},u={},f={},p=[],v=[],a=0,h=2,m=["browse","play","restrict","record"],y=[],g={pattern:"",request:"",type:"none",headers:[]},b=null,w=0,k=-1,L=-1,S=null,E=null;function A(e,t){(f[e]||[]).forEach(function(e){e.apply(null,t)})}function x(){return document.body.offsetHeight-document.getElementById("header").offsetHeight-document.querySelector("#footer").offsetHeight}function _(){document.getElementById("content").style.height=x()+"px"}function I(){var e=document.querySelector("#sidepanel");e.style.height=x()+"px";var t=document.querySelector("#sidepanel .navbar"),n=document.querySelector("#sidepanel .actioneditor"),a=document.querySelector("#sidepanel .restrictioneditor"),o=document.querySelector("#sidepanel .restrictioneditor .header"),i=document.querySelector("#sidepanel .restrictioneditor .editor"),r=document.querySelector("#sidepanel .content");a.style.width=e.offsetWidth+"px",i.style.width=e.offsetWidth+"px",i.style.height=a.offsetHeight-o.offsetHeight+"px";var s=e.offsetHeight-(t.offsetHeight+n.offsetHeight);r.style.height=s+"px",r.style.width=e.offsetWidth+"px",n.style.width=e.offsetWidth+"px",n.querySelector("table").style.width=n.offsetWidth+"px";var c=document.querySelector("body.view_sessionDetection #sidepanel .content .request_value");if(c){var d=document.querySelector("#sidepanel .pattern_editor");c.style.height=s-(t.offsetHeight+d.offsetHeight)+4+"px"}}function q(){var e=document.body.offsetWidth-document.getElementById("sidepanel").offsetWidth;document.getElementById("browser").style.width=e+"px"}function M(){var e=S.offsetWidth+2,t=S.offsetHeight+2;return{width:e&=-2,height:t&=-2}}function C(e){switch(e.button){case 0:return"left";case 1:return"middle";case 2:return"right"}}function D(){!function(e){var t=document.getElementById("bottomCover"),n=document.getElementById("rightCover");if(r.width){var a=e.height-r.height,o=e.width-r.width;n.style.width=0<o?o+"px":"0px",t.style.height=0<a?a+"px":"0px"}}(M()),A("frame.sizechange",[M()])}function T(){for(var e=document.getElementById("nptAddr"),t=e.parentNode,n=t.querySelectorAll("*"),a=0,o=0,i=!1,r=0;r<n.length;r++){var s=n[r];s!==e?i?o+=s.offsetWidth:a+=s.offsetWidth:i=!0}var c=a+o,d=t.offsetWidth-c;e.style.width=d-51+"px"}function P(){A("urlgoto",[document.getElementById("nptAddr").value])}function R(){document.getElementById("windowListMenu").style.display="none"}function N(e){if(e.startsWith("window."))return A("switchwindow",[e.split(".")[1]]),!1;switch(e){case"browser.go":P(),S.focus();break;case"browser.refresh":A("pagereload");break;case"browser.back":A("historyback");break;case"browser.forward":A("historyforward");break;case"browser.windows":!function(){var e=document.getElementById("windowListMenu");if(0===e.querySelectorAll("*").length)return;e.onclick=function(e){e.target&&(e.target.classList.contains("close_button")&&(e.stopPropagation(!0),A("closewindow",[e.target.dataset.windowindex])),R())},e.onblur=function(){R(),e.onblur=function(){}},0===e.offsetWidth?(e.style.display="block",e.setAttribute("tabindex",0),e.focus()):(e.style.display="none",e.removeAttribute("tabindex"))}();break;case"action.movedown":if(k<p.length-1){var t=p.splice(k,1)[0];p.splice(k+1,0,t),k++,G()}break;case"action.moveup":if(0<k){var n=p.splice(k,1)[0];p.splice(k-1,0,n),k--,G()}break;case"action.delete":p.splice(k,1),k=-1,G();break;case"action.add":(o=document.getElementById("actionAddMenu")).onblur=o.onclick=function(){o.style.display="none",o.onblur=function(){}},0===o.offsetWidth?(o.style.display="block",o.setAttribute("tabindex",0),o.focus()):(o.style.display="none",o.removeAttribute("tabindex"));break;case"action.add.change":case"action.add.click":case"action.add.keypress":case"action.add.manual":case"action.add.navigate":!function(e){var t={type:e};switch(e){case"navigate":t.target="";break;case"change":case"click":t.target="",t.parameters={value:""};break;case"keypress":t.target="",t.parameters={key:"",value:""}}var n=-1===k?p.length:k+1;a=oe(t,n,{fromUserGesture:!0}),k=a,G(),$(pe());var a}(e.split(".").pop());break;case"restriction.add":a=ie("",-1===L?v.length:L+1),L=a,j(),K(v[L]);break;case"restriction.delete":v.splice(L,1),L=-1,j();break;case"fs.open":c.lsr.open();break;case"fs.save":case"fs.saveas":A("savelsr",[de()]);break;case"import.load":c.selenium.open();break;default:console.log("unknown",e)}var a,o;A("buttonclick",[U(e)])}function z(){for(var e=document.querySelectorAll(".button"),t=0;t<e.length;t++){var n=e[t];if(!n.dataset.id)throw new Error("Button must have data-id attribute");if(l[n.dataset.id])throw new Error("Button id must be unique ["+n.dataset.id+"]");var a=new s(n);a.onclick=function(e){N(e)},l[n.dataset.id]=a}}function F(){!function(){var e={prev:document.querySelector("#btnWizPrev"),next:document.querySelector("#btnWizNext")};e.prev.disabled=!0,e.next.disabled=!0,w+1<=h&&(e.next.disabled=!1);a<=w-1&&(e.prev.disabled=!1)}(),function(){for(var e=document.querySelectorAll("#header .forWizard .step"),t=["leftArrow","rightArrow","current"],n=0;n<e.length;n++)for(var a=e[n],o=0;o<t.length;o++)a.classList.remove(t[o]);switch(e[w].classList.add("current"),w){case 0:e[0].classList.add("rightArrow");case 1:e[0].classList.add("leftArrow"),e[w].classList.add("rightArrow");break;case 2:e[1].classList.add("leftArrow")}}(),O(function(e){for(var t=document.querySelectorAll("#header .forWizard .step"),n=0;n<t.length;n++)if(n===e)return t[n].dataset.forview;return null}(w))}function W(){for(var e=[],t=document.querySelectorAll("#header .viewSelector .tab"),n=0;n<t.length;n++)e.push(t[n]);return e}function B(){for(var e=document.body.classList,t=0;t<e.length;t++){var n=e[t];if(0===n.indexOf("view_"))return n.substr(5)}}function H(){var e=W(),t=B();e.forEach(function(e){e.classList.remove("selected"),e.dataset.viewname===t&&e.classList.add("selected")})}function O(t){if(B()===t)return!1;var e,n,a=(e=W(),n=[],e.forEach(function(e){n.push(e.dataset.viewname)}),n);J(),a.forEach(function(e){e!==t?document.body.classList.remove("view_"+e):document.body.classList.add("view_"+t)}),function(e){switch(A("viewchange",[e]),e){case"loginActions":G();break;case"restrictions":j();break;case"sessionDetection":Y()}}(t),H(),I()}function U(e){return l[e]}function e(e){for(var t in l){l[t].forceDisable(e)}}function X(){return document.querySelector("#sidepanel .content")}function V(e){X().appendChild(e)}function J(){X().innerHTML=""}function j(){if("restrictions"!==B())return!1;J();var e=U("restriction.delete");e.disable(),v.forEach(function(e,t){var n=document.createElement("div");n.className="restriction";var a=document.createElement("span");a.className="empty_restriction",a.appendChild(document.createTextNode(i("Empty request (edit it below)"))),t===L&&n.classList.add("selected"),n.addEventListener("click",function(){L=t,j(),K(v[t])});var o=e.getDescription();n.setAttribute("title",o),n.appendChild(document.createTextNode(o)),0===o.length&&n.appendChild(a),V(n)}),-1!==L?(document.querySelector("#sidepanel .restrictioneditor .editor").classList.remove("norestriction"),e.enable()):document.querySelector("#sidepanel .restrictioneditor .editor").classList.add("norestriction"),document.querySelector("#sidepanel .restrictioneditor .editor textarea").oninput=function(e){v[L]=new o(this.value),j()}}function Y(){if("sessionDetection"!==B())return!1;J();var e=new n(u["validation_request"]);V(e.root),b&&re(b),e.root.querySelector(".request_value").addEventListener("input",function(){se()})}function G(){if("loginActions"!==B())return!1;J();var e=U("action.moveup"),t=U("action.movedown"),n=U("action.delete");e.disable(),t.disable(),n.disable(),p.forEach(function(e,t){var n=document.createElement("div"),a=document.createElement("div");a.className="icon",n.appendChild(a),n.className="action",a.classList.add(e.getType()),t===k&&n.classList.add("selected"),n.addEventListener("click",function(){k=t,G(),$(Q(t))});var o=e.getDescription();n.setAttribute("title",o),n.appendChild(document.createTextNode(o)),V(n)}),-1!==k?(document.querySelector("#sidepanel .actioneditor .editor").classList.remove("noaction"),n.enable(),0!==k&&e.enable(),k!==p.length-1&&t.enable()):document.querySelector("#sidepanel .actioneditor .editor").classList.add("noaction"),Me()}function K(e){document.querySelector("#sidepanel .restrictioneditor .editor textarea").value=e.getSavable()}function Q(e){return p[e]}function Z(){return{inputs:{type:document.querySelector("#sidepanel .actioneditor .editor .nptActionType"),target:document.querySelector("#sidepanel .actioneditor .editor .nptActionTarget"),timeout:document.querySelector("#sidepanel .actioneditor .editor .nptActionTimeout"),value:document.querySelector("#sidepanel .actioneditor .editor .nptActionValue"),key:document.querySelector("#sidepanel .actioneditor .editor .nptActionKey")},rows:{type:document.querySelector("#sidepanel .actioneditor .editor .actionType"),target:document.querySelector("#sidepanel .actioneditor .editor .actionTarget"),timeout:document.querySelector("#sidepanel .actioneditor .editor .actionTimeout"),value:document.querySelector("#sidepanel .actioneditor .editor .actionValue"),key:document.querySelector("#sidepanel .actioneditor .editor .actionKey")}}}function $(e){var t=Z();for(var n in t.rows)t.rows[n].style.display="none";switch(t.rows.type.style.display="",e.getType()){case"navigate":case"click":t.rows.target.style.display="",t.rows.timeout.style.display="";break;case"change":t.rows.target.style.display="",t.rows.timeout.style.display="",t.rows.value.style.display="";break;case"keypress":t.rows.target.style.display="",t.rows.timeout.style.display="",t.rows.key.style.display=""}t.inputs.type.value=e.getType(),t.inputs.target.value=e.getTarget(),t.inputs.timeout.value=e.getTimeout(),t.inputs.key.value=e.getParameters().key,e.isPasswordValue()?t.inputs.value.type="password":t.inputs.value.type="text",t.inputs.value.value=e.getParameters().value,t.inputs.target.focus(),I()}function ee(){var t=[];return p.forEach(function(e){t.push({parameters:e.getParameters(),target:e.getTarget(),timeout:e.getTimeout(),type:e.getType()})}),t}function te(){var a=[];return v.forEach(function(e){if("POST"===e.getMethod()){var t="".concat(e.getMethod()," ").concat(e.getUrl()," HTTP/1.1\n"),n=e.getContentType();n&&(t+="Content-Type: ".concat(n,"\n")),t+="\n".concat(e.getBody()),a.push(t)}else a.push("".concat(e.getMethod()," ").concat(e.getUrl()," HTTP/1.1"))}),a}function ne(e){var t=(e=e||{}).actions||[],n=e.restrictions||[];p.length=0,G(),t.forEach(function(e){oe(e)}),v.length=0,j(),n.forEach(function(e){ie(e)}),b=e.detection,Y(),I()}function ae(e,t,n){return e instanceof Array&&(void 0!==n?(n=(n=(n|=0)<0?0:n)>e.length?e.length:n,e.splice(n,0,t)):e.push(t),n||e.length-1)}function oe(e,t,n){if(n=n||{},"navigate"!==e.type&&!function(){for(var e=0;e<p.length;e++)if("navigate"===p[e].getType())return!0;return!1}()&&!0!==n.fromUserGesture)return 0;var a=new d(e),o=ae(p,a,t);return G(),o}function ie(e,t){var n=new o(e),a=ae(v,n,t);return j(),a}function re(e){var t,n,a;"none"===(t=e).type&&""===t.pattern&&(t.type="statusis",t.pattern="200"),b=e,document.querySelector("#sidepanel .pattern_editor .nptValidIf").value=e.type,n=e.pattern,a=he(),ve()[a].querySelector(".pattern_value").value=n,me(a),document.querySelector("#sidepanel .content .request_value").value=e.request,ce()}function se(){var e,t=document.querySelector("body.view_sessionDetection #sidepanel .content .request_value"),n=document.querySelector("#sidepanel .pattern_editor .nptValidIf");(b=b||{}).type=n.value,b.request=t.value,b.pattern=(e=he(),ve()[e].querySelector(".pattern_value").value),ce()}function ce(){b&&0<b.request.length?U("detection.check").enable():U("detection.check").disable()}function de(){var e={actions:ee(),detection:b||g,restrictions:te(),config:{viewport:M()}};return JSON.stringify(e,null,4)}function le(){var e=JSON.parse(de()),t=e.actions,n=e.config;return JSON.stringify({actions:t,config:n},null,4)}function ue(e){var t=window._ACX_lsrutils,n=t.getLSRFromHTML(e)||t.getLSRFromSIDE(e);return!!n&&n.actions}function fe(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=document.createElement("input"),n=function(){};return t.setAttribute("accept",e.join(",")),t.style.display="none",t.type="file",t.addEventListener("change",function(e){e&&e.target&&e.target.files&&n(e.target.files[0]),this.value=""}),document.body.appendChild(t),{open:function(){t.click()},setFileHandler:function(e){n=e}}}function pe(){return p[k]}function ve(){for(var e={},t=document.querySelectorAll("#sidepanel .pattern_editor .pattern_input"),n=0;n<t.length;n++){var a=t[n];e[a.dataset.fortype]=a}return e}function he(){var e=document.querySelector("#sidepanel .pattern_editor .nptValidIf");return e.options[e.selectedIndex].dataset.type}function me(e){var t=ve();for(var n in t)t[n].style.display=n===e?"table-row":"none"}function ye(){var e=["current","error"];be().forEach(function(t){e.forEach(function(e){t.classList.remove(e)})})}function ge(e,t){ye();var n,a=(n=e,be()[n]);a&&a.classList.add(t)}function be(){for(var e=[],t=document.querySelectorAll("#sidepanel .content div.action"),n=0;n<t.length;n++)e.push(t[n]);return e}function we(){if(0===y.length)return!1;Ae(y.shift())}function ke(){return null!==document.querySelector(".modal_backdrop")}function Le(){if(!ke())return!1;var e=document.querySelector(".modal_backdrop");e.parentNode.removeChild(e)}var Se=function(){(Se=Ee).apply(void 0,arguments),setTimeout(function(){document.getElementById("visibleCanvas").style.display="block"},200)};function Ee(n){var e=new Blob([n.blob],{type:"image/jpg"}),a=URL.createObjectURL(e),o=new Image;o.onload=function(){var e,t;E.drawImage(o,0,0,o.naturalWidth,o.naturalHeight,0,0,n.metadata.deviceWidth,n.metadata.deviceHeight),r.width=n.metadata.deviceWidth,r.height=n.metadata.deviceHeight,e=document.getElementById("bottomCover"),t=document.getElementById("rightCover"),e.style.height="0px",t.style.width="0px",URL.revokeObjectURL(a),o=null,A("frame.draw",[n.sessionId])},o.src=a}function Ae(n){if(ke())return y.push(n),!1;var e,a=n.callback||function(){},t=n.options||{},o=((e=document.createElement("div")).className="modal_backdrop",e.style.position="absolute",e.style.left="0px",e.style.right="0px",e.style.top="0px",e.style.bottom="0px",e.style.zIndex=10,e.style.backgroundColor="#00000057",document.body.appendChild(e),e);o.style.visibility="hidden";for(var i,r=(i=n.id,document.querySelector(".modal_template_"+i).cloneNode(!0)),s={},c=r.querySelectorAll("*"),d=0;d<c.length;d++){var l=c[d];l.dataset.clickcallback&&l.dataset.id?l.onclick=function(){var e={editable:{}};for(var t in s)e.editable[t]=s[t].value;a(this.dataset.id,e),o.parentNode&&o.parentNode.removeChild(o),we()}:l.dataset.editable&&t.editable&&void 0!==t.editable[l.dataset.editable]&&((s[l.dataset.editable]=l).value=t.editable[l.dataset.editable]),l.dataset.showif&&(t.showif&&t.showif[l.dataset.showif]||(l.style.display="none"))}r.style.display="block",n.values&&r.querySelectorAll("*").forEach(function(e){var t=e.dataset;t.value&&n.values[t.value]&&(e.innerHTML="",e.appendChild(document.createTextNode(n.values[t.value].split("\\n").join("\n"))))});var u=document.createElement("div");u.className="modal",u.style.position="absolute",u.style.left="0px",u.style.right="0px",u.style.top="0px",u.style.bottom="0px",u.style.width="400px",u.style.margin="auto",u.style.zIndex=20;var f=document.createElement("div");f.className="title";var p=document.createElement("div");return p.className="content",u.appendChild(f),u.appendChild(p),f.innerHTML="",f.appendChild(document.createTextNode(r.dataset.title)),p.appendChild(r),o.appendChild(u),u.style.height=f.offsetHeight+p.offsetHeight+"px",o.style.visibility="visible",!0}function xe(e,t){var n=document.getElementById("sidepanel"),a=document.body.offsetWidth-e,o=n.offsetWidth,i=n.offsetTop,r=x()+i,s=o-Math.floor(5);return a<=o+Math.floor(5)&&s<=a&&i<t&&t<r}function _e(e){_(),T(),q(),I(),D(),!0!==e&&setTimeout(function(){_e(!0)},200)}function Ie(){return Math.floor((new Date).getTime()/1e3)}function qe(){t=Ie()}function Me(){0!==p.length?["wizcontrols.play","controls.play"].forEach(function(e){U(e).enable()}):["wizcontrols.play","controls.play"].forEach(function(e){U(e).disable()})}function Ce(e,t){Ae({id:"alert",values:{message:e},callback:t})}return{init:function(e){S=document.querySelector("#browser .stream");var n,a,o,i,t,r=document.createElement("canvas"),s=document.querySelector("canvas");s.setAttribute("width",window.screen.width),s.setAttribute("height",window.screen.height),r.setAttribute("width",window.screen.width),r.setAttribute("height",window.screen.height),r.getContext("2d",{alpha:!1}),E=s.getContext("2d",{alpha:!1}),document.getElementById("nptAddr").addEventListener("keydown",function(e){-1!==["Enter","NumpadEnter"].indexOf(e.code||e.key)&&(P(),S.focus())}),function(){for(var e=document.querySelectorAll(".template"),t=0;t<e.length;t++){var n=e[t],a=n.dataset.id;delete n.dataset.id,u[a]=n.cloneNode(!0),n.parentNode.removeChild(n)}}(),H(),_(),q(),I(),a=n=!1,o=[],t=!(i={}),S.setAttribute("tabIndex","0"),S.contentEditable=!0,S.style.cursor="default",S.style.color="rgba(0,0,0,0)",S.addEventListener("paste",function(e){a=!0,o=Object.keys(i),e.stopPropagation(),e.preventDefault(),A("paste",[(e.clipboardData||window.clipboardData).getData("text")])}),S.addEventListener("click",function(e){S.focus()}),S.addEventListener("mousemove",function(e){return A("canvas.mousemove",[{x:e.offsetX,y:e.offsetY}]),e.preventDefault(),!1}),S.addEventListener("mouseup",function(e){return A("canvas.mouseup",[{x:e.offsetX,y:e.offsetY,button:C(e)}]),e.preventDefault(),t=!1}),S.addEventListener("mousedown",function(e){return C(e),A("canvas.mousedown",[{x:e.offsetX,y:e.offsetY,button:C(e)}]),e.preventDefault(),!(t=!0)}),S.addEventListener("mouseout",function(e){t&&(A("canvas.mouseup",[{x:e.offsetX,y:e.offsetY,button:C(e)}]),t=!1)}),window.addEventListener("focus",function(){Object.keys(i).forEach(function(e){delete i[e],A("canvas.keyup",[{key:e}])})}),S.addEventListener("keypress",function(e){var t=e.code||e.key;if(!e.ctrlKey&&!e.altKey)return n=!0,delete i[t],A("canvas.charpress",[e.key]),e.preventDefault(e),!1}),S.addEventListener("keydown",function(e){var t=e.code||e.key;if(i[t]=!0,1!==e.key.length)return A("canvas.keydown",[{key:t}]),e.preventDefault(),!1;n=!1,this.innerHTML="","Tab"===t&&e.preventDefault()}),S.addEventListener("keyup",function(e){var t=e.code||e.key;return i[t]&&(1!==e.key.length?(delete i[t],A("canvas.keyup",[{key:t}])):!1!==n||a||A("canvas.keydownup",[{key:t}]),0<o.length&&o.forEach(function(e){delete i[e],A("canvas.keyup",[{key:e}])}),0===Object.keys(i).length&&(a=!1),e.preventDefault()),!1}),S.addEventListener("wheel",function(e){return A("canvas.mousewheel",[{deltaX:e.deltaX<0?-100:0<e.deltaX?100:0,deltaY:e.deltaY<0?-100:0<e.deltaY?100:0,offsetX:e.offsetX,offsetY:e.offsetY}]),e.preventDefault(),!1}),z(),W().forEach(function(e){e.addEventListener("click",function(){O(this.dataset.viewname)})}),T(),c.lsr=fe([".lsr"]),c.lsr.setFileHandler(function(e){var t,n;t=e,(n=new FileReader).addEventListener("load",function(e){if(e&&e.target&&e.target.result){var t;try{t=JSON.parse(e.target.result)}catch(e){Ce("Invalid LSR File"),t={}}ne(t)}}),n.readAsText(t)}),c.selenium=fe([".side",".html"]),c.selenium.setFileHandler(function(e){!function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},t=new FileReader;t.addEventListener("load",function(e){if(!e||!e.target||!e.target.result)return!1;var t=ue(e.target.result.toString());n(t)}),t.readAsText(e)}(e,function(e){if(!e)return Ce("Cannot parse Selenium script"),!1;ne({actions:e}),A("startPlayAndDetect",[e])})}),function(){var t=Z().inputs;for(var e in t)t[e].addEventListener("input",function(){var e=pe();e.setParameters({key:t.key.value,value:t.value.value}),e.setType(t.type.value),e.setTarget(t.target.value),e.setTimeout(t.timeout.value),G()})}(),function(){var e=ve(),t=document.querySelector("#sidepanel .pattern_editor .nptValidIf");for(var n in t.addEventListener("change",function(){me(this.options[this.selectedIndex].dataset.type),se()}),e)e[n].addEventListener("input",function(){se()});me("status")}(),F(),function(){document.querySelector("#btnWizFinish").addEventListener("click",function(){A("savelsr",[de()])}),document.querySelector("#btnSaveLogic").addEventListener("click",function(){A("savelogic",[le()])}),document.querySelector("#btnWizNext").addEventListener("click",function(){w++,F()}),document.querySelector("#btnWizPrev").addEventListener("click",function(){w--,F()});for(var e=document.querySelectorAll(".btnClose"),t=0;t<e.length;t++)e[t].addEventListener("click",function(){A("closerequest",[{dontShowAgain:document.querySelector("#manualDontShowAgain").checked}])})}(),function(){var n=document.getElementById("sidepanel"),a=240;window.addEventListener("mousemove",function(e){xe(e.clientX,e.clientY)?document.body.classList.add("horizontal_resize"):document.body.classList.remove("horizontal_resize")});var o=0,i=0;function t(e){var t=o+(i-e.clientX);if(t<a)return r(),!1;n.style.width=t+"px",_e()}function r(){window.removeEventListener("mouseup",r),window.removeEventListener("mousemove",t)}window.addEventListener("mousedown",function(e){xe(e.clientX,e.clientY)&&(i=e.clientX,o=n.offsetWidth,window.addEventListener("mousemove",t),window.addEventListener("mouseup",r))})}(),window.addEventListener("resize",function(){_e()}),window.addEventListener("click",function(e){e.target!==S&&A("defocusPage")})},on:function(e,t){var n,a;a=t,f[n=e]=f[n]||[],f[n].push(a)},drawFrame:Se,getFrameSize:function(){return M()},addAction:function(e){oe(e)},addRestriction:function(e){ie(e)},updateURL:function(e){document.getElementById("nptAddr").value=e},getCurrentURL:function(){return document.getElementById("nptAddr").value},updateHistoryButtons:function(e){var t=U("browser.back"),n=U("browser.forward");t.disable(),n.disable(),e.canGoBack&&t.enable(),e.canGoForward&&n.enable()},getActionList:function(){return ee()},getActionByIndex:function(e){return Q(e)},getRestrictionList:function(){return te()},disableInteraction:function(){e(!0)},enableInteraction:function(){e(!1)},markActionErrorByIndex:function(e){ge(e,"error")},markActionByIndex:function(e){ge(e,"current")},getMode:function(){for(var e=0;e<m.length;e++)if(document.body.classList.contains("mode_".concat(m[e])))return m[e];return null},setMode:function(e){switch(U("wizcontrols.record").deactivate(),U("controls.record").deactivate(),U("wizcontrols.play").deactivate(),U("controls.play").deactivate(),U("wizcontrols.restrict").deactivate(),U("controls.restrict").deactivate(),U("wizcontrols.detect_nav").deactivate(),U("controls.detect_nav").deactivate(),U("controls.play").show(),U("wizcontrols.play").show(),U("controls.resume").hide(),U("wizcontrols.resume").hide(),U("controls.stop").disable(),U("wizcontrols.stop").disable(),U("controls.record").enable(),U("wizcontrols.record").enable(),Me(),m.forEach(function(e){document.body.classList.remove("mode_"+e)}),-1!==m.indexOf(e)&&document.body.classList.add("mode_"+e),e){case"pause":O("loginActions"),U("controls.play").hide(),U("wizcontrols.play").hide(),U("controls.resume").show(),U("wizcontrols.resume").show(),document.body.classList.add("mode_play");break;case"play":k=-1,G(),ye(),O("loginActions"),U("controls.play").activate(),U("wizcontrols.play").activate(),U("controls.stop").enable(),U("wizcontrols.stop").enable(),U("controls.record").disable(),U("wizcontrols.record").disable();break;case"restrict":O("restrictions"),U("wizcontrols.restrict").activate(),U("controls.restrict").activate();break;case"record":O("loginActions"),U("controls.record").activate(),U("wizcontrols.record").activate();break;case"detect":O("sessionDetection"),U("controls.detect_nav").activate(),U("wizcontrols.detect_nav").activate()}},showRestrictionModal:function(e,t){return Ae({id:"restrict",options:e,callback:t})},showDetectionModal:function(e){return Ae({id:"detect_status",callback:e})},hideDetectionModal:function(){Le()},showSequenceCheckModal:function(e){return Ae({id:"sequence_check",callback:e})},showPreMIModal:function(){return Ae({id:"pre_mi"})},hidePreMIModal:function(){this.hideModals()},showPostMIModal:function(){return Ae({id:"post_mi"})},hidePostMIModal:function(){this.hideModals()},showSiteloginInitModal:function(){return Ae({id:"site_login_init"})},showSiteloginPlayModal:function(){return Ae({id:"site_login_play"})},hideModals:function(e){Le()},cancelNextRestrictionModals:function(){!function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;if(null===e)return y.length=0;for(var t=y.length-1;-1<t;t--)y[t].id===e&&y.splice(t,1)}("restrict")},loadPattern:function(e){re(e)},getSessionPattern:function(){return b||""},enableDetectFromHistory:function(){U("controls.detect_history").enable()},setCursor:function(e){"auto"===e&&(e="default"),document.querySelector("#browser .stream").style.cursor=e},loadDataFromJSON:function(e){ne(e)},getActionValues:function(){var n=[];return p.forEach(function(e){var t=e.getParameters();t.value&&-1===n.indexOf(t.value)&&n.push(t.value)}),n},getActionNavURLs:function(){var t=[];return p.forEach(function(e){"navigate"===e.getType()&&t.push(e.getTarget())}),t},notifyReadyForInput:function(){document.body.classList.remove("state_connecting"),qe(),window.addEventListener("mousemove",qe),window.addEventListener("click",qe),window.addEventListener("keydown",qe)},getState:function(){return e=0,null!==t&&(e=Ie()-t),{visible:"visible"===document.visibilityState,idleSeconds:e};var e},showNavigationLoader:function(){var e=U("browser.refresh"),t=U("browser.navigating");e.hide(),t.show()},hideNavigationLoader:function(){var e=U("browser.refresh"),t=U("browser.navigating");e.show(),t.hide()},detectFromSeleniumData:function(e){return!!(t=ue(e))&&(ne({actions:t}),A("startPlayAndDetect",[t]),!0);var t},updateWindowList:function(e){var t=e.list,n=e.total,a=U("browser.windows");0<n?a.enable():a.disable(),document.querySelector("#windowListMenu").innerHTML="",t.forEach(function(e,t){var n=e.title,a=e.url;0===(n=n.trim()).length&&(n=a),function(e,t){var n=document.querySelector("#windowListMenu"),a=document.createElement("div");a.className="button",a.dataset.image="images/application.png",a.dataset.id="window.".concat(t),a.appendChild(document.createTextNode(e));var o=document.createElement("span");o.className="close_button",o.dataset.windowindex=t+"",o.appendChild(document.createTextNode("x")),a.appendChild(o),n.appendChild(a);var i=new s(a);i.onclick=function(e){N(e)},l[a.dataset.id]=i}(n,t)})},getJSONForLogic:function(){return le()},setCloseButtonText:function(e){document.querySelector("#btnSaveLogic").value=e},hideManualIntervention:function(){var e=U("action.add.manual");e&&e.hide()},alert:Ce,confirm:function(e,t){Ae({id:"confirm",values:{message:e},callback:function(e){t("ok"===e)}})},prompt:function(e,a){Ae({id:"prompt",values:{message:e},options:{editable:{response:""}},callback:function(e,t){var n=t.editable;a("ok"===e?n.response:null)}})}}}();